---
title: 'Argenomic: Illuminating Chemical Space'
date: 2020-07-05
permalink: /posts/2020/07/argenomic/
tags:
  - Evolutionary Algorithms
  - Computational Drug Design
  - Software Package
---

![logo](/images/logo.png)

Chemists search through the space of molecules to discover new drugs, often aided by search algorithms, which automatically explore a search space to
find high-performing solutions. With argenomic we provide a novel type of algorithm that produces a large diversity of high-performing, yet qualitatively different molecules, illuminates the fitness of molecules over chemical space, and improves search efficiency compared to both machine learning and genetic algorithm approaches.

Shining a light on chemical space
------

The goal of a classical optimisation algorithm is to obtain the highest performing solution in a search space. If the exact mathematical form of the evaluation function is inaccessible, as is typically the case in molecular optimisation, heuristic search methods tend to become a necessity. Many of these heuristic methods are inspired by biological phenomena. Genetic algorithms are based on the theory of evolution and aim to optimise with regard to an evaluation function, incrementally improving on existing solutions. Specifically, novel solutions are generated by randomly changing or stochastically combining solutions from the existing population. In the genetic algorithm community, these two operations are respectively known as *mutations* and *crossovers*. Genetic algorithms can be highly effective in straightforward optimisation problems, but are known to struggle when trying to cross low-performing valleys or to break out of local optima, both of these occurrences can lead to evolutionary stagnation. 

![surface](/images/surface_final.png)
*Figure 1. Example of illumination in a 2D representation of chemical space. In this case the fitness is determined as the molecular similarity to [Troglitazone](https://en.wikipedia.org/wiki/Troglitazone).*

Argenomic evades evolutionary stagnation by enforcing molecular diversity and speeds up the optimisation process by decoupling mutations from crossovers, and introduces the concept of positional analogue scanning to genetic algorithms. In argenomic, candidate solutions are generated by a genetic algorithm but are assigned to a niche -- in which only the single fittest candidate survives -- depending on user-defined characterising features. Dividing the search space into feature-based niches and explicitly enforcing population diversity stands in stark contrast with classical genetic algorithms which typically only retain the top high-scoring solutions regardless of their diversity, or lack thereof. The enforced variation between niches makes crossovers more diverse, and by mutating existing solutions, potent scaffolds can spread into other niches. Most importantly, because at every generation argenomic contains solutions spread out over feature space, diverse solutions in far-away niches can be used a resource to escape stagnation. 

![surface](/images/comparison_GBGA_GBEPI-1.png)
*Figure 2. Performance of a genetic algoritm (GB-GA) and argenomic (GB-EPI) for the rediscovery of [Celecoxib](https://en.wikipedia.org/wiki/Celecoxib), illustrated by the best score of each generation over 100 independent runs. For each run, the starting populations consisted of 40 random compounds from the ZINC database.*

The fitness score obtained by the molecule occupying a niche at the end of an argenomic run represents the capability of the corresponding part of feature space to contain high-performance molecules. In this way, argenomic *illuminates* the relationship between the chosen features of interest and how varying them affects performance, either positively or, equally relevant, negatively. As can be seen in Figure 1, the molecules at the end of a GB-EPI run form a patchwork of locally elite solutions (with respect to the global evaluation function) in of chemical space.

Handing over the reins
------

In practical terms, users of argenomic can choose their own features of interest, and define relevant ranges of variation to construct a feature space. If, for instance, a user wants to find medicinally relevant molecules in chemical space, they could construct a feature space based on physicochemical properties like lipophilicity and molecular mass, and practical concerns like synthetic accessibility. The chosen ranges in which to explore these features can be used to specify  a desired subset of chemical space in which to generate new molecules. 


Standing on the shoulders of giants
------
As in all creative endeavors, the ideas behind argenomic were not born in a vaccuum. The projected was kickstarted by discovering the [multi-dimensional archive of phenotypic elites](https://arxiv.org/abs/1504.04909) (MAP-Elites) as devised by [Jean-Baptiste Mouret](https://members.loria.fr/JBMouret/) and [Jeff Clune](http://jeffclune.com/). MAP-Elites is a simple, efficacious and surprisingly powerful tool developed in the context of soft robot design, which solves stagnation issues in genetic algorithms by mimicing biological evolutionary diversity as described above. We settled on a [graph-based genetic algorithm](https://pubs.rsc.org/en/content/articlelanding/2019/SC/C8SC05372C#!divAbstract) as our underlying molecular optimisation tool. In a graph-based genetic algorithm, candiate molecules are represented by their molecular graph and *mutations* and *crossovers* are implemented as actions on the graph. Thanks to [Jan H. Jensen](https://chem.ku.dk/ansatte/alle/?pure=en/persons/300883) a fully [open-source implementation](https://github.com/jensengroup/GB-GA) was available. In-depth technical discussions can be found in our [accompanying paper](https://chemrxiv.org/). The [source code](https://github.com/Jonas-Verhellen/Argenomic) of argenomic can be found on github. 
